olaresManifest.version: '0.10.0'
olaresManifest.type: app
metadata:
  name: comfyuishare
  description: The most powerful and modular stable diffusion GUI and backend.
  icon: https://file.bttcdn.com/appstore/comfyui/icon2.png
  appid: comfyuishare
  version: '1.2.22'
  title: ComfyUI Shared
  categories:
  - Creativity
  - Productivity
entrances:
- name: comfyuientrance
  host: comfyuientrance
  port: 8080
  title: ComfyUI
  icon: https://file.bttcdn.com/appstore/comfyui/icon2.png
  authLevel: internal
  openMethod: window
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}
- name: comfyuilauncherweb
  host: comfyuientrance
  port: 8081
  title: ComfyUI Launcher
  icon: https://file.bttcdn.com/appstore/comfyui/launcher2.png
  authLevel: private
{{- end }}
# - name: comfyuilauncherserver
#   host: comfyuientrance
#   port: 8082
#   title: Comfyui Launcher Server
#   icon: https://file.bttcdn.com/appstore/comfyui/icon.png
#   authLevel: public
#   invisible: true
permission:
  appData: true
  appCache: true
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}
  userData:
  - Home
  sysData:
  - dataType: legacy_api
    group: api.intent
    appName: desktop
    svc: edge-desktop
    namespace: user-space
    port: 80
    version: v1
    ops:
    - POST
{{- end }}
spec:
  versionName: '0.3.60'
  featuredImage: https://file.bttcdn.com/appstore/comfyui/1.png
  promoteImage:
  - https://file.bttcdn.com/appstore/comfyui/1.png
  - https://file.bttcdn.com/appstore/comfyui/2.png
  - https://file.bttcdn.com/appstore/comfyui/3.png
  - https://file.bttcdn.com/appstore/comfyui/4.png
  fullDescription: |
    ## IMPORTANT NOTE ##
    This is a shared version of ComfyUI. Only one service will be installed across the entire Olares system. However, every user still needs to install an desktop entry to access and use the service installed by the Olares Admin.

    After installation, everyone on this Olares cluster can use the same application. This shared setup makes it easier for users to share information with each other, while reducing maintenance work and using fewer resources.

    ## OVERVIEW ##
    The most powerful and modular stable diffusion GUI and backend.

    This ui will let you design and execute advanced stable diffusion pipelines using
    a graph/nodes/flowchart based interface.

    Features
    - Nodes/graph/flowchart interface to experiment and create complex Stable Diffusion workflows without needing to code anything.
    - Image Models
      * SD1.x, SD2.x,
      * SDXL, SDXL Turbo
      * Stable Cascade
      * SD3 and SD3.5
      * Pixart Alpha and Sigma
      * AuraFlow
      * HunyuanDiT
      * Flux
      * Lumina Image 2.0
      * HiDream
      * Cosmos Predict2
      * Qwen Image
    - Image Editing Models
      * Omnigen 2
      * Flux Kontext
      * HiDream E1.1
      * Qwen Image Edit
    - Video Models
      * Stable Video Diffusion
      * Mochi
      * LTX-Video
      * Hunyuan Video
      * Nvidia Cosmos and Cosmos Predict2
      * Wan 2.1
      * Wan 2.2
    - Audio Models
      * Stable Audio
      * ACE Step
    - 3D Models
      * Hunyuan3D 2.0
    - Asynchronous Queue system
    - Many optimizations: Only re-executes the parts of the workflow that changes between executions.
    - Smart memory management: can automatically run models on GPUs with as low as 1GB vram.
    - Works even if you don't have a GPU with: --cpu (slow)
    - Can load ckpt, safetensors and diffusers models/checkpoints. Standalone VAEs and CLIP models.
    - Embeddings/Textual inversion
    - Loras (regular, locon and loha)
    - Hypernetworks
    - Loading full workflows (with seeds) from generated PNG, WebP and FLAC files.
    - Saving/Loading workflows as Json files.
    - Nodes interface can be used to create complex workflows like one for Hires fix or much more advanced ones.
    - Area Composition
    - Inpainting with both regular and inpainting models.
    - ControlNet and T2I-Adapter
    - Upscale Models (ESRGAN, ESRGAN variants, SwinIR, Swin2SR, etc...)
    - unCLIP Models
    - GLIGEN
    - Model Merging
    - LCM models and Loras
    - Latent previews with TAESD
    - Starts up very fast.
    - Works fully offline: core will never download anything unless you want to.
    - Optional API nodes to use paid models from external providers through the online Comfy API.
    - Config file to set the search paths for models.

  upgradeDescription: |
    Update ComfyUI to v0.3.60

    What's Changed
    Support hunyuan image distilled model. by @comfyanonymous in #9807
    Update template to 0.1.81 by @comfyui-wiki in #9811
    Fast preview for hunyuan image. by @comfyanonymous in #9814
    Implement hunyuan image refiner model. by @comfyanonymous in #9817
    Add Output to V3 Combo type to match what is possible with V1 by @Kosinkadink in #9813
    Bump frontend to 1.26.11 by @benceruleanlu in #9809
    Add noise augmentation to hunyuan image refiner. by @comfyanonymous in #9831
    Fix hunyuan refiner blownout colors at noise aug less than 0.25 by @comfyanonymous in #9832
    Set default hunyuan refiner shift to 4.0 by @comfyanonymous in #9833
    API nodes: add kling-v2-1 model to the KlingStartEndFrame node by @bigcat88 in #9630
    [V3] convert Minimax API nodes to the V3 schema by @bigcat88 in #9693
    [V3] convert WanCameraEmbedding node to V3 schema by @bigcat88 in #9714
    [V3] convert Cosmos nodes to V3 schema by @bigcat88 in #9721
    [V3] convert nodes_cond.py to V3 schema by @bigcat88 in #9719
    [V3] convert CFG nodes to V3 schema by @bigcat88 in #9717
    [V3] convert Canny node to V3 schema by @bigcat88 in #9743
    [V3] convert Moonvalley API nodes to the V3 schema by @bigcat88 in #9698
    Better way of doing the generator for the hunyuan image noise aug. by @comfyanonymous in #9834
    Enable Runtime Selection of Attention Functions by @Kosinkadink in #9639
    Hunyuan refiner vae now works with tiled. by @comfyanonymous in #9836
    Support wav2vec base models by @kijai in #9637
    Cleanup. by @comfyanonymous in #9838
    HunyuanImage: delete single quote pattern to avoid wrong text matches by @KimbingNg in #9842
    Add support for Chroma Radiance by @blepping in #9682
    Changes to the previous radiance commit. by @comfyanonymous in #9851
    Make ModuleNotFoundError ImportError instead by @Kosinkadink in #9850
    Add that hunyuan image is supported to readme. by @comfyanonymous in #9857
    Support the omnigen2 umo lora. by @comfyanonymous in #9886
    Fix python -O and BatchedBrownianTree w0 handling by @blepping in #9884
    Add encoder part of whisper large v3 as an audio encoder model. by @comfyanonymous in #9894
    Reduce Peak WAN inference VRAM usage by @rattus128 in #9898
    Support the 1.7B HuMo model. by @comfyanonymous in #9903
    Support the HuMo 17B model. by @comfyanonymous in #9912
    Enable fp8 ops by default on gfx1200 by @0xDELUXA in #9926
    Fix image sharpen node by @jetjodh in #9932
    Do padding of audio embed in model for humo for more flexibility. by @comfyanonymous in #9935
    Bump frontend to 1.26.13 by @christian-byrne in #9933
    Basic WIP support for the wan animate model. by @comfyanonymous in #9939
    fix(api_nodes): reduce default timeout from 7 days to 2 hours by @bigcat88 in #9918
    fix(seedream4): add flag to ignore error on partial success by @bigcat88 in #9952
    Update WanAnimateToVideo to more easily extend videos. by @comfyanonymous in #9959
    Add inputs for character replacement to the WanAnimateToVideo node. by @comfyanonymous in #9960
    [Reviving #5709] Add strength input to Differential Diffusion by @Kosinkadink in #9957
    Fix LoRA Trainer bugs with FP8 models. by @KohakuBlueleaf in #9854
    Lower wan memory estimation value a bit. by @comfyanonymous in #9964
    Set some wan nodes as no longer experimental. by @comfyanonymous in #9976
    Support for qwen edit plus model. Use the new TextEncodeQwenImageEditPlus node. by @comfyanonymous in #9986
    Add offset param to /history endpoint by @christian-byrne in #9977
    Fix bug with WanAnimateToVideo node. by @comfyanonymous in #9988
    Fix bug with WanAnimateToVideo. by @comfyanonymous in #9990
    update template to 0.1.86 by @comfyui-wiki in #9998
    feat(api-nodes): add wan t2i, t2v, i2v nodes by @bigcat88 in #9996

    View full release note at: https://github.com/comfyanonymous/ComfyUI/releases/tag/v0.3.60

  developer: Comfy Org
  website: https://www.comfy.org/
  sourceCode: https://github.com/comfyanonymous/ComfyUI
  submitter: Olares
  locale:
  - en-US
  - zh-CN
  doc: https://docs.comfy.org/get_started/introduction
  license:
  - text: GPL-3.0
    url: https://github.com/comfyanonymous/ComfyUI?tab=GPL-3.0-1-ov-file#readme
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}
  requiredGpu: 2Gi
  requiredMemory: 2Gi
  requiredCpu: 0.25
  requiredDisk: 10Gi
  limitedGpu: 16Gi
  limitedMemory: 30.5Gi
  limitedCpu: 4.1
  limitedDisk: 40Gi
{{- else }}
  requiredMemory: 64Mi
  limitedMemory: 256Mi
  requiredDisk: 1Mi
  limitedDisk: 100Mi
  requiredCpu: 10m
  limitedCpu: 100m
{{- end }}
  supportArch:
  - amd64
options:
  apiTimeout: 0
  conflicts:
  - name: comfyui
    type: application
  - name: comfyuiclient
    type: application  
  dependencies:
  - name: olares
    type: system
    version: '>=1.11.6-0'
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}
{{- else }}
  - name: comfyuishare
    type: application
    version: '>=1.2.0'
    mandatory: true
{{- end }}
  appScope:
{{- if and .Values.admin .Values.bfl.username (eq .Values.admin .Values.bfl.username) }}  
    clusterScoped: true
    appRef:
    - comfyuishare
{{- else }}
    clusterScoped: false
{{- end }}