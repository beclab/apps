olaresManifest.version: '0.10.0'
olaresManifest.type: middleware
metadata:
  name: mongodb
  appid: mongodb
  description: Olares Middleware for MongoDB
  icon: https://app.cdn.olares.com/appstore/mongodb/icon.png
  version: '6.0.21'
  title: MongoDB 6.0
  categories:
  - Developer Tools
  - Utilities
spec:
  onlyAdmin: true
  versionName: '6.0.21'
  fullDescription: |
    MongoDB is a popular document-oriented NoSQL database used for storing and retrieving data. It is designed to provide scalability, flexibility, and high performance for modern applications.

    This MongoDB middleware is based on Percona Server for MongoDB. It is a highly scalable database that is fully compatible with MongoDB 6.0 Community Edition.

    You can find the full list of new features and improvements in MongoDB 6.0 Community edition release notes: https://www.mongodb.com/docs/v6.0/release-notes/6.0/.
  upgradeDescription: |
    Upgrade mongodb to version 6.0.21

    The bug fixes, provided by MongoDB Community Edition and included in Percona Server for MongoDB, are the following:
    - SERVER-94405 - Re-enable autosplitting on the sessions collection when downgrading to version 5.0.x and setting the Feature Compatibility Version (FCV) to 5.0
    - SERVER-96252 - Fixed the issue with upgrading to a new FCV when there are range deletion tasks and no hashed shard key index by setting the number of orphan documents to zero
    - SERVER-98720 - Added redaction of the BSON command for "Plan executor error" warning logs to prevent the entire command text (possibly including PII) to end up in the logs
    - SERVER-100594 - Limited JSON recursion to 200 levels
    - SERVER-101298 - Removed acquisition of database and collection locks when acquiring the global lock in compaction
    - SERVER-97842 - Fixed the issue with MongoDB CPU usage spikes with a newer version of OpenSSL on RHEL 9

    Find the full list of changes in: https://www.mongodb.com/docs/v6.0/release-notes/6.0-changelog/#6.0.21-changelog

    Changelog
    New Features:
    - PSMDB-1282 - Add the security.kmip.useLegacyProtocol config file option to simplify migration from MongoDB Enterprise Edition to Percona Server for MongoDB
    
    Improvements:
    - PSMDB-1620 - Do not create an empty audit log file if the log destination is not file
    - PSMDB-1621 - Check if an audit log file can be opened for writing at default path

    Bugs Fixed:
    - PSMDB-118 - Fixed the audit log file extension to be created based on the specified audit log format.
    - PSMDB-121 - Fixed the issue with the server failing to create an audit log file at the user provided path when the process is forked and the relative path is given by converting it to an absolute path
    - PSMDB-1227 - Allowed setting a Distinguished Name(DN) value in attributes part of the LDAP query
    - PSMDB-1392 - Ensured that $backupCursor returns oplogEnd without holes (Thank you MingTotti Guoming He for reporting this issue)
    - PSMDB-1614 - Replaced a hard-coded port number with a placeholder in percona-server-enable-authentication.sh
    - PSMDB-1617 - Improved error messages when there are insufficient permissions to access client/CA certificates for KMIP authentication

    Find the full release notes of Percona Server for MongoDB in: https://docs.percona.com/percona-server-for-mongodb/6.0/release_notes/6.0.21-18.html

  developer: MongoDB, Inc.
  website: https://www.mongodb.com/
  submitter: Olares
  locale:
  - en-US
  - zh-CN
  requiredMemory: 32Mi
  limitedMemory: 80Gi
  requiredDisk: 512Mi
  limitedDisk: 50Gi
  requiredCpu: 100m
  limitedCpu: 200000m
  supportArch:
  - amd64
  - arm64
  runAsUser: true
options:
  dependencies:
  - name: olares
    type: system
    version: '>=1.12.2-0'
  images:
    - apecloud/percona-server-mongodb:6.0.21
    - apecloud/percona-backup-mongodb:2.9.1
    - apecloud/mongodb_exporter:0.44.0
    - apecloud/syncer:0.6.4
    - apecloud/kubectl:1.29
entrances:
  - name: mongodb
    port: 27017
    host: mongodb-mongodb-headless
    title: MongoDB 6.0
    icon: https://app.cdn.olares.com/appstore/mongodb/icon.png
